async function appelerIA() {
    const niche = document.getElementById('niche').value;
    const loader = document.getElementById('loader');
    const resultDiv = document.getElementById('result');
    const output = document.getElementById('output');

    if(!niche) return alert("Indique une niche !");

    loader.style.display = 'block';
    resultDiv.style.display = 'none';

    try {
        const response = await fetch(`/api/generate?niche=${encodeURIComponent(niche)}`);
        const data = await response.json();

        // On vérifie si l'IA a bien répondu
        if (data.candidates && data.candidates[0].content) {
            const texteIA = data.candidates[0].content.parts[0].text;
            loader.style.display = 'none';
            resultDiv.style.display = 'block';
            output.innerText = texteIA;
        } else {
            // Si ça échoue, on affiche l'erreur réelle de Google
            loader.style.display = 'none';
            alert("Message de Google : " + (data.error || "Réponse incomplète"));
        }
    } catch (error) {
        loader.style.display = 'none';
        alert("Erreur réseau. Vérifie ta connexion.");
    }
}
